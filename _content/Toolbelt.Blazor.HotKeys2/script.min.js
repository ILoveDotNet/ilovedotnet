const t=document,i="OnKeyDown",r=["button","checkbox","color","file","image","radio","range","reset","submit",],u="INPUT",f="keydown";class h{constructor(n,t,i,r,u,f,e){this.dotNetObj=n;this.mode=t;this.modifiers=i;this.keyEntry=r;this.exclude=u;this.excludeSelector=f;this.state=e}action(){this.dotNetObj.invokeMethodAsync("InvokeAction")}}const e=n=>t.addEventListener(f,n),o=n=>t.removeEventListener(f,n),c=n=>{return{OS:"Meta",Decimal:"Period"}[n.key]||n.key},n=(n,t)=>n.startsWith(t),l=(n,t,i,f)=>(n.exclude&1)!=0&&i===u&&r.every(n=>n!==f)?!0:(n.exclude&2)!=0&&i===u&&r.some(n=>n===f)?!0:(n.exclude&4)!=0&&i==="TEXTAREA"?!0:(n.exclude&8)!=0&&t.isContentEditable?!0:n.excludeSelector!==""&&t.matches(n.excludeSelector)?!0:!1,s=n=>t=>{if(typeof t.altKey!="undefined"){const i=t.getModifierState("NumLock"),r=i&&t.code.match(/^Numpad([0-9]|Decimal)$/)&&!t.key.match(/^[0-9\.]$/)?!0:t.shiftKey,u=(r?1:0)+(t.ctrlKey?2:0)+(t.altKey?4:0)+(t.metaKey?8:0),f=c(t),e=t.code,o=[t.target,t.composedPath()[0]].filter(n=>n).map(n=>[n,n.tagName,n.getAttribute("type")]),s=n(u,f,e,o);s&&t.preventDefault()}};export const createContext=()=>{let r=0;const t=new Map,u=(i,r,u,f)=>{let e=!1;return t.forEach(t=>{if(!t.state.disabled){const h=t.mode===1,c=h?u:r,o=t.keyEntry;if(o!==c)return;const a=h?i:i&65534;let s=h?t.modifiers:t.modifiers&65534;if(n(o,"Shift")&&h&&(s|=1),n(o,"Control")&&(s|=2),n(o,"Alt")&&(s|=4),n(o,"Meta")&&(s|=8),a!==s)return;if(f.some(([i,n,r])=>l(t,i,n,r)))return;e=e||t.state.preventDefault;t.action()}}),e},i=s(u);return e(i),{register:(n,i,u,f,e,o,s)=>{const c=r++,l=new h(n,i,u,f,e,o,s);return t.set(c,l),c},update:(n,i)=>{const r=t.get(n);r&&(r.state=i)},unregister:n=>{n!==-1&&t.delete(n)},dispose:()=>{o(i)}}},handleKeyEvent=(n,t)=>{const u=(r,u,f,e)=>{const[,o,s]=e[0];return t?n.invokeMethod(i,r,o,s,u,f):(n.invokeMethodAsync(i,r,o,s,u,f),!1)},r=s(u);return e(r),{dispose:()=>{o(r)}}};